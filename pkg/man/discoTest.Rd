\name{discoTest}
\alias{discoTest}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
  Perform disco normal...
}
\description{
  %%  ~~ A concise (1-5 lines) description of what the function does. ~~
  This function computes the ...
}
\usage{
discoTest(freqs)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  %%     ~~Describe \code{freqs} here~~
  \item{freqs}{data frame of score frequencies with probe(set)s as rows and score
    labels as columns.}
}
\details{
  %%  ~~ If necessary, more details than the description above ~~
  freqs contains the score frequencies data frame generated by
  getQuantileFreqs, or, alternatively, the combined frequencies
  generated by combineQuantileFreqs. Each row is for a probe/probeset
  from the original expression data, and each column is a score label
  (for example, if n.quantiles=4 was chosen for getQuantileScores, there
  will be 5 scores labels: -2,-1,0,1,2; so these labels will be the
  column labels for the freqs data frame). If freqs was generated by
  combineQuantileFreqs, there will be additional columns for the
  corresponding probe/probeset IDs from the additional platforms.
}
\value{
  %%  ~Describe the value returned
  %%  If it is a LIST, use
  %%  \item{comp1 }{Description of 'comp1'}
  %%  \item{comp2 }{Description of 'comp2'}
  %% ...
  \item{p.value}{p-value from Chi-Square distribution...}
  % \item{chisq}{Chi-Square value from Chi-Square distribution...}
  \item{alpha1}{alpha1...}
  % \item{beta1.2}{beta1...}
  \item{alpha2}{alpha2...}
  % \item{beta1.4}{beta2...}
  
}
\references{
  %% ~put references to the literature/web site here ~
  which paper?
}
\author{
  %%  ~~who you are~~
  Sadik A. Khuder, Peter S. Bazeley
}
\note{
  %%  ~~further notes~~
  Additional notes...?
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
  %% ~~objects to See Also as \code{\link{help}}, ~~~
  \code{\link{getQuantileScores}}, \code{\link{getQuantileFreqs}}, \code{\link{combineQuantileFreqs}}
}
\examples{
##START

library(QuantCombine)

#first 1000 genes from 3 GSEs from GSE6969 SuperSeries
data(spermatogenesis)
ls()

##Example 1 - single data set

#not needed for analysis, but lists samples/groups
gse6872.gsms

#calculate quantile scores
gse6872.sc = getQuantileScores(gse6872,gse6872.grp1,gse6872.grp2)

#calculate quantile score frequencies
gse6872.fr = getQuantileFreqs(gse6872.sc,gse6872.grp1,gse6872.grp2)

res = discoTest(gse6872.fr)
res



##Example 2 - 3 datasets/platforms

#not needed for analysis, but lists samples/groups
gse6872.gsms #Affymetrix HGU133 Plus 2.0
gse6967.gsms #Illumina Sentrix Human6 BeadChip
gse6968.gsms #Illumina Sentrix HumanRef8 BeadChip

#calculate quantile scores
gse6872.sc = getQuantileScores(gse6872,gse6872.grp1,gse6872.grp2)
gse6967.sc = getQuantileScores(gse6967,gse6967.grp1,gse6967.grp2)
gse6968.sc = getQuantileScores(gse6968,gse6968.grp1,gse6968.grp2)

#calculate quantile score frequencies
gse6872.fr = getQuantileFreqs(gse6872.sc,gse6872.grp1,gse6872.grp2)
gse6967.fr = getQuantileFreqs(gse6967.sc,gse6967.grp1,gse6967.grp2)
gse6968.fr = getQuantileFreqs(gse6968.sc,gse6968.grp1,gse6968.grp2)

#combine score frequencies from gse6872 and gse6867
gse6872.6967.fr = combineQuantileFreqs(d1.fr=gse6872.fr,
                                       d2.fr=gse6967.fr,
                  ID.map=AffymetrixHGU133Plus2.and.IlluminaSentrixHuman6)

#same number of rows in output as in
# AffymetrixHGU133Plus2.and.IlluminaSentrixHuman6 ID.map
nrow(gse6872.6967.fr)
nrow(AffymetrixHGU133Plus2.and.IlluminaSentrixHuman6)

gse6872.6967.fr[1:10,]


#combine score frequencies from gse6872, gse6967, and gse6968
gse6872.6967.6968.fr = combineQuantileFreqs(d1.fr=gse6872.6967.fr,
                                            d2.fr=gse6968.fr,
               ID.map=AffymetrixHGU133Plus2.and.IlluminaSentrixHumanRef8)

#Human6 and HumanRef8 chips have many similar transcripts, so in this
# case, no further probes are removed by combining with gse6968.fr
#Human6 and HumanRef8 chips have many similar transcripts, so in this
# case, only a few more probes are removed by combining with gse6968.fr

nrow(gse6872.6967.6968.fr)

gse6872.6967.6968.fr[1:10,]

res = discoTest(gse6872.6967.6968.fr)
res

##END
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ ~kwd1 }
\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line
